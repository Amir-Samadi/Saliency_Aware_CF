This repository provides a PyTorch implementation of SAFE and coresponding net, SAcleGAN, for Counterfactual generation. SAFE framwrok consists SAcyleGAN and the subject grey-box. 

<p align="center"><img width="100%" src="jpg/rafd_results.jpg" /></p>
Order: The Learned Attention Mask, The Learned Content Mask, Final Results.

<p align="center"><img width="100%" src="jpg/celeba_comparison.jpg" /></p>
Order: The Learned Attention Mask, The Learned Content Mask, Final Results.


## Acknowledgments
This source code is inspired by [StarGAN](https://github.com/yunjey/stargan), [AttentionGAN] https://github.com/Ha0Tang/AttentionGANand, and [grad-cam] https://github.com/jacobgil/pytorch-grad-cam. 

## Contributions
If you have any questions/comments/bug reports, feel free to open a github issue or pull a request or e-mail to the author Amir Samadi [amir.samadi@warwick.ac.uk].

